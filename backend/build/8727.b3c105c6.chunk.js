(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[8727],{6937:(T,g,e)=>{"use strict";e.d(g,{A:()=>u});var t=e(21272),d=e(5287),r=e(33544),o=e.n(r),a=e(54894);const i=({errors:A,values:s,onChange:h,canEditInputs:v})=>{const{formatMessage:n}=(0,a.A)();return t.createElement(d.T,{label:n({id:"Settings.tokens.form.description",defaultMessage:"Description"}),id:"description",error:A.description?n(A.description?.id?A.description:{id:A.description,defaultMessage:A.description}):null,onChange:h,disabled:!v},s.description)};i.propTypes={errors:o().shape({description:o().string}),onChange:o().func.isRequired,canEditInputs:o().bool.isRequired,values:o().shape({description:o().string}).isRequired},i.defaultProps={errors:{}};const u=i},18727:(T,g,e)=>{"use strict";e.d(g,{A:()=>Ye});var t=e(21272),d=e(38413),r=e(4198),o=e(83997),a=e(51337),i=e(2506),u=e(54894),A=e(74930),s=e(69267),h=e(17703),v=e(33544),n=e.n(v);const c=(0,t.createContext)({}),l=({children:p,...f})=>t.createElement(c.Provider,{value:f},p),m=()=>(0,t.useContext)(c);l.propTypes={children:n().node.isRequired};var E=e(80005),C=e(71526),I=e(55286),S=e(38168),b=e(54134),D=e(94061),M=e(30893),B=e(90151),R=e(68074),F=e(91146),N=e(6937),Y=e(28506),$=e(85021);const X=({errors:p,onChange:f,canEditInputs:y,isCreating:L,values:O,apiToken:k,onDispatch:x,setHasChangedPermissions:Q})=>{const{formatMessage:H}=(0,u.A)(),V=({target:{value:G}})=>{Q(!1),G==="full-access"&&x({type:"SELECT_ALL_ACTIONS"}),G==="read-only"&&x({type:"ON_CHANGE_READ_ONLY"})},w=[{value:"read-only",label:{id:"Settings.tokens.types.read-only",defaultMessage:"Read-only"}},{value:"full-access",label:{id:"Settings.tokens.types.full-access",defaultMessage:"Full access"}},{value:"custom",label:{id:"Settings.tokens.types.custom",defaultMessage:"Custom"}}];return t.createElement(D.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:4},t.createElement(M.o,{variant:"delta",as:"h2"},H({id:"global.details",defaultMessage:"Details"})),t.createElement(B.x,{gap:5},t.createElement(R.E,{key:"name",col:6,xs:12},t.createElement(Y.A,{errors:p,values:O,canEditInputs:y,onChange:f})),t.createElement(R.E,{key:"description",col:6,xs:12},t.createElement(N.A,{errors:p,values:O,canEditInputs:y,onChange:f})),t.createElement(R.E,{key:"lifespan",col:6,xs:12},t.createElement(F.A,{isCreating:L,errors:p,values:O,onChange:f,token:k})),t.createElement(R.E,{key:"type",col:6,xs:12},t.createElement($.A,{values:O,errors:p,label:{id:"Settings.tokens.form.type",defaultMessage:"Token type"},onChange:G=>{V({target:{value:G}}),f({target:{name:"type",value:G}})},options:w,canEditInputs:y})))))};X.propTypes={errors:n().shape({name:n().string,description:n().string,lifespan:n().string,type:n().string}),onChange:n().func.isRequired,canEditInputs:n().bool.isRequired,values:n().shape({name:n().string,description:n().string,lifespan:n().oneOfType([n().number,n().string]),type:n().string}).isRequired,isCreating:n().bool.isRequired,apiToken:n().shape({id:n().oneOfType([n().number,n().string]),type:n().string,lifespan:n().string,name:n().string,accessKey:n().string,permissions:n().array,description:n().string,createdAt:n().string}),onDispatch:n().func.isRequired,setHasChangedPermissions:n().func.isRequired},X.defaultProps={errors:{},apiToken:{}};const Z=X;var ne=e(55356),le=e(85963),Te=e(54514);const _=({apiTokenName:p})=>{const{formatMessage:f}=(0,u.A)();return(0,a.L4)(),t.createElement(d.g,{"aria-busy":"true"},t.createElement(a.x7,{name:"API Tokens"}),t.createElement(ne.Q,{primaryAction:t.createElement(le.$,{disabled:!0,startIcon:t.createElement(Te.A,null),type:"button",size:"L"},f({id:"global.save",defaultMessage:"Save"})),title:p||f({id:"Settings.apiTokens.createPage.title",defaultMessage:"Create API Token"})}),t.createElement(r.s,null,t.createElement(a.Bl,null)))};_.defaultProps={apiTokenName:null},_.propTypes={apiTokenName:n().string};const de=_;var ce=e(34542),se=e.n(ce),ae=e(61468),oe=e.n(ae),re=e(63891);const Pe=p=>{switch(p){case"POST":return{text:"success600",border:"success200",background:"success100"};case"GET":return{text:"secondary600",border:"secondary200",background:"secondary100"};case"PUT":return{text:"warning600",border:"warning200",background:"warning100"};case"DELETE":return{text:"danger600",border:"danger200",background:"danger100"};default:return{text:"neutral600",border:"neutral200",background:"neutral100"}}},Oe=(0,re.Ay)(D.a)`
  margin: -1px;
  border-radius: ${({theme:p})=>p.spaces[1]} 0 0 ${({theme:p})=>p.spaces[1]};
`;function pe({route:p}){const{formatMessage:f}=(0,u.A)(),{method:y,handler:L,path:O}=p,k=O?oe()(O.split("/")):[],[x="",Q=""]=L?L.split("."):[],H=Pe(p.method);return t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:2},t.createElement(M.o,{variant:"delta",as:"h3"},f({id:"Settings.apiTokens.createPage.BoundRoute.title",defaultMessage:"Bound route to"}),"\xA0",t.createElement("span",null,x),t.createElement(M.o,{variant:"delta",textColor:"primary600"},".",Q)),t.createElement(o.s,{hasRadius:!0,background:"neutral0",borderColor:"neutral200",gap:0},t.createElement(Oe,{background:H.background,borderColor:H.border,padding:2},t.createElement(M.o,{fontWeight:"bold",textColor:H.text},y)),t.createElement(D.a,{paddingLeft:2,paddingRight:2},se()(k,V=>t.createElement(M.o,{key:V,textColor:V.includes(":")?"neutral600":"neutral900"},"/",V)))))}pe.defaultProps={route:{handler:"Nocontroller.error",method:"GET",path:"/there-is-no-path"}},pe.propTypes={route:n().shape({handler:n().string,method:n().string,path:n().string})};const xe=pe,Re=()=>{const{value:{selectedAction:p,routes:f}}=m(),{formatMessage:y}=(0,u.A)(),L=p?.split(".")[0];return t.createElement(R.E,{col:5,background:"neutral150",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,style:{minHeight:"100%"}},p?t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:2},f[L]?.map(O=>O.config.auth?.scope?.includes(p)||O.handler===p?t.createElement(xe,{key:O.handler,route:O}):null)):t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:2},t.createElement(M.o,{variant:"delta",as:"h3"},y({id:"Settings.apiTokens.createPage.permissions.header.title",defaultMessage:"Advanced settings"})),t.createElement(M.o,{as:"p",textColor:"neutral600"},y({id:"Settings.apiTokens.createPage.permissions.header.hint",defaultMessage:"Select the application's actions or the plugin's actions and click on the cog icon to display the bound route"}))))};var Ie=e(57237),De=e(60888),Se=e(44604),ve=e(4181),Le=e(20415),Be=e(24092),ke=e.n(Be);const Ce=(0,re.AH)`
  background: ${p=>p.theme.colors.primary100};
  svg {
    opacity: 1;
  }
`,Ue=(0,re.Ay)(D.a)`
  display: flex;
  justify-content: space-between;
  align-items: center;

  svg {
    opacity: 0;
    path {
      fill: ${p=>p.theme.colors.primary600};
    }
  }

  /* Show active style both on hover and when the action is selected */
  ${p=>p.isActive&&Ce}
  &:hover {
    ${Ce}
  }
`,We=re.Ay.div`
  flex: 1;
  align-self: center;
  border-top: 1px solid ${({theme:p})=>p.colors.neutral150};
`,ue=({controllers:p,label:f,orderNumber:y,disabled:L,onExpanded:O,indexExpandendCollapsedContent:k})=>{const{value:{onChangeSelectAll:x,onChange:Q,selectedActions:H,setSelectedAction:V,selectedAction:w}}=m(),[G,ie]=(0,t.useState)(!1),{formatMessage:Ee}=(0,u.A)(),q=()=>{ie(U=>!U),O(y)};(0,t.useEffect)(()=>{k!==null&&k!==y&&G&&ie(!1)},[k,y,G]);const K=U=>U===w;return t.createElement(Ie.n,{expanded:G,onToggle:q,variant:y%2?"primary":"secondary"},t.createElement(De.P,{title:ke()(f)}),t.createElement(Se.u,null,p?.map(U=>{const ee=U.actions.every(j=>H.includes(j.actionId)),fe=U.actions.some(j=>H.includes(j.actionId));return t.createElement(D.a,{key:`${f}.${U?.controller}`},t.createElement(o.s,{justifyContent:"space-between",alignItems:"center",padding:4},t.createElement(D.a,{paddingRight:4},t.createElement(M.o,{variant:"sigma",textColor:"neutral600"},U?.controller)),t.createElement(We,null),t.createElement(D.a,{paddingLeft:4},t.createElement(ve.S,{value:ee,indeterminate:!ee&&fe,onValueChange:()=>{x({target:{value:[...U.actions]}})},disabled:L},Ee({id:"app.utils.select-all",defaultMessage:"Select all"})))),t.createElement(B.x,{gap:4,padding:4},U?.actions&&U?.actions.map(j=>t.createElement(R.E,{col:6,key:j.actionId},t.createElement(Ue,{isActive:K(j.actionId),padding:2,hasRadius:!0},t.createElement(ve.S,{value:H.includes(j.actionId),name:j.actionId,onValueChange:()=>{Q({target:{value:j.actionId}})},disabled:L},j.action),t.createElement("button",{type:"button","data-testid":"action-cog",onClick:()=>V({target:{value:j.actionId}}),style:{display:"inline-flex",alignItems:"center"}},t.createElement(Le.A,null)))))))})))};ue.defaultProps={controllers:[],orderNumber:0,disabled:!1,onExpanded:()=>null,indexExpandendCollapsedContent:null},ue.propTypes={controllers:n().array,orderNumber:n().number,label:n().string.isRequired,disabled:n().bool,onExpanded:n().func,indexExpandendCollapsedContent:n().number};const be=ue,ge=({section:p,...f})=>{const[y,L]=(0,t.useState)(null),O=k=>L(k);return t.createElement(D.a,{padding:4,background:"neutral0"},p&&p.map((k,x)=>t.createElement(be,{key:k.apiId,label:k.label,controllers:k.controllers,orderNumber:x,indexExpandendCollapsedContent:y,onExpanded:O,name:k.apiId,...f})))};ge.defaultProps={section:null},ge.propTypes={section:n().arrayOf(n().object)};const Ke=ge,Ne=({...p})=>{const{value:{data:f}}=m(),{formatMessage:y}=(0,u.A)();return t.createElement(B.x,{gap:0,shadow:"filterShadow",hasRadius:!0,background:"neutral0"},t.createElement(R.E,{col:7,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:2},t.createElement(M.o,{variant:"delta",as:"h2"},y({id:"Settings.apiTokens.createPage.permissions.title",defaultMessage:"Permissions"})),t.createElement(M.o,{as:"p",textColor:"neutral600"},y({id:"Settings.apiTokens.createPage.permissions.description",defaultMessage:"Only actions bound by a route are listed below."}))),f?.permissions&&t.createElement(Ke,{section:f?.permissions,...p})),t.createElement(Re,null))},$e=(0,t.memo)(Ne);var me=e(31713);const je=(p,f=[])=>({...p,selectedAction:null,routes:[],selectedActions:[],data:(0,me.z1)(f)});var Fe=e(88761),ze=e(92173),Me=e.n(ze);const He={data:{},selectedActions:[]},Ve=(p,f)=>(0,Fe.Ay)(p,y=>{switch(f.type){case"ON_CHANGE":{y.selectedActions.includes(f.value)?Me()(y.selectedActions,f.value):y.selectedActions.push(f.value);break}case"SELECT_ALL_IN_PERMISSION":{f.value.every(O=>y.selectedActions.includes(O.actionId))?f.value.forEach(O=>{Me()(y.selectedActions,O.actionId)}):f.value.forEach(O=>{y.selectedActions.push(O.actionId)});break}case"SELECT_ALL_ACTIONS":{y.selectedActions=[...y.data.allActionsIds];break}case"ON_CHANGE_READ_ONLY":{const L=y.data.allActionsIds.filter(O=>O.includes("find")||O.includes("findOne"));y.selectedActions=[...L];break}case"UPDATE_PERMISSIONS_LAYOUT":{y.data=(0,me.z1)(f.value);break}case"UPDATE_ROUTES":{y.routes={...f.value};break}case"UPDATE_PERMISSIONS":{y.selectedActions=[...f.value];break}case"SET_SELECTED_ACTION":{y.selectedAction=f.value;break}default:return y}}),Ge="Name already taken",Ye=()=>{(0,a.L4)();const{formatMessage:p}=(0,u.A)(),{lockApp:f,unlockApp:y}=(0,a.MA)(),L=(0,a.hN)(),O=(0,h.W6)(),k=(0,s.d4)(C.G),[x,Q]=(0,t.useState)(O.location.state?.apiToken.accessKey?{...O.location.state.apiToken}:null),{trackUsage:H}=(0,a.z1)(),V=(0,t.useRef)(H),{setCurrentStep:w}=(0,a.Cx)(),{allowedActions:{canCreate:G,canUpdate:ie,canRegenerate:Ee}}=(0,a.ec)(k.settings["api-tokens"]),[q,K]=(0,t.useReducer)(Ve,He,P=>je(P,{})),{params:{id:U}}=(0,h.W5)("/settings/api-tokens/:id"),{get:ee,post:fe,put:j}=(0,a.ry)(),z=U==="create";(0,A.useQuery)("content-api-permissions",async()=>{const[P,J]=await Promise.all(["/admin/content-api/permissions","/admin/content-api/routes"].map(async te=>{const{data:W}=await ee(te);return W.data}));K({type:"UPDATE_PERMISSIONS_LAYOUT",value:P}),K({type:"UPDATE_ROUTES",value:J}),x&&(x?.type==="read-only"&&K({type:"ON_CHANGE_READ_ONLY"}),x?.type==="full-access"&&K({type:"SELECT_ALL_ACTIONS"}),x?.type==="custom"&&K({type:"UPDATE_PERMISSIONS",value:x?.permissions}))},{onError(){L({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),(0,t.useEffect)(()=>{V.current(z?"didAddTokenFromList":"didEditTokenFromList",{tokenType:I.I})},[z]);const{status:Qe}=(0,A.useQuery)(["api-token",U],async()=>{const{data:{data:P}}=await ee(`/admin/api-tokens/${U}`);return Q({...P}),P?.type==="read-only"&&K({type:"ON_CHANGE_READ_ONLY"}),P?.type==="full-access"&&K({type:"SELECT_ALL_ACTIONS"}),P?.type==="custom"&&K({type:"UPDATE_PERMISSIONS",value:P?.permissions}),P},{enabled:!z&&!x,onError(){L({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),Xe=async(P,J)=>{V.current(z?"willCreateToken":"willEditToken",{tokenType:I.I}),f();const te=P.lifespan&&parseInt(P.lifespan,10)&&P.lifespan!=="0"?parseInt(P.lifespan,10):null;try{const{data:{data:W}}=z?await fe("/admin/api-tokens",{...P,lifespan:te,permissions:P.type==="custom"?q.selectedActions:null}):await j(`/admin/api-tokens/${U}`,{name:P.name,description:P.description,type:P.type,permissions:P.type==="custom"?q.selectedActions:null});z&&(O.replace(`/settings/api-tokens/${W.id}`,{apiToken:W}),w("apiTokens.success")),y(),Q({...W}),L({type:"success",message:p(z?{id:"notification.success.apitokencreated",defaultMessage:"API Token successfully created"}:{id:"notification.success.apitokenedited",defaultMessage:"API Token successfully edited"})}),V.current(z?"didCreateToken":"didEditToken",{type:x.type,tokenType:I.I})}catch(W){const he=(0,E.N_)(W.response.data);J.setErrors(he),W?.response?.data?.error?.message===Ge?L({type:"warning",message:W.response.data.message||"notification.error.tokennamenotunique"}):L({type:"warning",message:W?.response?.data?.message||"notification.error"}),y()}},[Je,ye]=(0,t.useState)(!1),Ze={...q,onChange:({target:{value:P}})=>{ye(!0),K({type:"ON_CHANGE",value:P})},onChangeSelectAll:({target:{value:P}})=>{ye(!0),K({type:"SELECT_ALL_IN_PERMISSION",value:P})},setSelectedAction:({target:{value:P}})=>{K({type:"SET_SELECTED_ACTION",value:P})}},Ae=ie&&!z||G&&z;return!z&&!x&&Qe!=="success"?t.createElement(de,{apiTokenName:x?.name}):t.createElement(l,{value:Ze},t.createElement(d.g,null,t.createElement(a.x7,{name:"API Tokens"}),t.createElement(i.l1,{validationSchema:me.wQ,validateOnChange:!1,initialValues:{name:x?.name||"",description:x?.description||"",type:x?.type,lifespan:x?.lifespan?x.lifespan.toString():x?.lifespan},enableReinitialize:!0,onSubmit:(P,J)=>Xe(P,J)},({errors:P,handleChange:J,isSubmitting:te,values:W,setFieldValue:he})=>(Je&&W?.type!=="custom"&&he("type","custom"),t.createElement(a.lV,null,t.createElement(S.A,{backUrl:"/settings/api-tokens",title:{id:"Settings.apiTokens.createPage.title",defaultMessage:"Create API Token"},token:x,setToken:Q,canEditInputs:Ae,canRegenerate:Ee,isSubmitting:te,regenerateUrl:"/admin/api-tokens/"}),t.createElement(r.s,null,t.createElement(o.s,{direction:"column",alignItems:"stretch",gap:6},Boolean(x?.name)&&t.createElement(b.A,{token:x?.accessKey,tokenType:I.I}),t.createElement(Z,{errors:P,onChange:J,canEditInputs:Ae,isCreating:z,values:W,apiToken:x,onDispatch:K,setHasChangedPermissions:ye}),t.createElement($e,{disabled:!Ae||W?.type==="read-only"||W?.type==="full-access"}))))))))}},20920:(T,g,e)=>{var t=e(87864),d=e(80151),r=e(29327),o=e(52689),a=e(76299),i=Array.prototype,u=i.splice;function A(s,h,v,n){var c=n?r:d,l=-1,m=h.length,E=s;for(s===h&&(h=a(h)),v&&(E=t(s,o(v)));++l<m;)for(var C=0,I=h[l],S=v?v(I):I;(C=c(E,S,C,n))>-1;)E!==s&&u.call(E,C,1),u.call(s,C,1);return s}T.exports=A},28506:(T,g,e)=>{"use strict";e.d(g,{A:()=>u});var t=e(21272),d=e(7537),r=e(33544),o=e.n(r),a=e(54894);const i=({errors:A,values:s,onChange:h,canEditInputs:v})=>{const{formatMessage:n}=(0,a.A)();return t.createElement(d.k,{name:"name",error:A.name?n(A.name?.id?A.name:{id:A.name,defaultMessage:A.name}):null,label:n({id:"Settings.tokens.form.name",defaultMessage:"Name"}),onChange:h,value:s.name,disabled:!v,required:!0})};i.propTypes={errors:o().shape({name:o().string}),onChange:o().func.isRequired,canEditInputs:o().bool.isRequired,values:o().shape({name:o().string}).isRequired},i.defaultProps={errors:{}};const u=i},29327:T=>{function g(e,t,d,r){for(var o=d-1,a=e.length;++o<a;)if(r(e[o],t))return o;return-1}T.exports=g},31713:(T,g,e)=>{"use strict";e.d(g,{N1:()=>a,wQ:()=>s,z1:()=>v});var t=e(6103),d=e(83058),r=e(96123);const a=(n,c,l="en")=>{if(c&&typeof c=="number"){const m=c/24/60/60/1e3;return(0,t.A)((0,d.A)(new Date(n),m),"PPP",{locale:r[l]})}return"Unlimited"};var i=e(51337),u=e(12083);const s=u.Ik().shape({name:u.Yj(i.iW.string).max(100).required(i.iW.required),type:u.Yj(i.iW.string).oneOf(["read-only","full-access","custom"]).required(i.iW.required),description:u.Yj().nullable(),lifespan:u.ai().integer().min(0).nullable().defined(i.iW.required)}),v=n=>{const c={allActionsIds:[],permissions:[]};return c.permissions=Object.keys(n).map(l=>({apiId:l,label:l.split("::")[1],controllers:Object.keys(n[l].controllers).map(m=>({controller:m,actions:n[l].controllers[m].map(E=>{const C=`${l}.${m}.${E}`;return l.includes("api::")&&c.allActionsIds.push(C),{action:E,actionId:C}}).flat()})).flat()})),c}},34542:(T,g,e)=>{var t=e(87864),d=e(45353),r=e(29884),o=e(82261);function a(i,u){var A=o(i)?t:r;return A(i,d(u,3))}T.exports=a},38168:(T,g,e)=>{"use strict";e.d(g,{A:()=>C});var t=e(21272),d=e(55356),r=e(83997),o=e(85963),a=e(51337),i=e(54514),u=e(46270),A=e(33544),s=e.n(A),h=e(54894),v=e(70603),n=e(60256);const c=(I,S,b,D)=>{const[M,B]=(0,t.useState)(!1),R=(0,a.hN)(),{post:F}=(0,a.ry)(),{formatAPIError:N}=(0,a.wq)();return{regenerateData:async()=>{try{const{data:{data:{accessKey:$}}}=await F(`${I}${S}/regenerate`);B(!1),b($)}catch($){B(!1),D?D($):$ instanceof n.pe&&R({type:"warning",message:N($)})}},isLoadingConfirmation:M}},l=({onRegenerate:I,idToRegenerate:S,backUrl:b,onError:D})=>{const{formatMessage:M}=(0,h.A)(),[B,R]=(0,t.useState)(!1),{regenerateData:F,isLoadingConfirmation:N}=c(b,S,I,D),Y=async()=>{F(),R(!1)};return t.createElement(t.Fragment,null,t.createElement(o.$,{startIcon:t.createElement(v.A,null),type:"button",size:"S",variant:"tertiary",onClick:()=>R(!0),name:"regenerate"},M({id:"Settings.tokens.regenerate",defaultMessage:"Regenerate"})),t.createElement(a.TM,{bodyText:{id:"Settings.tokens.popUpWarning.message",defaultMessage:"Are you sure you want to regenerate this token?"},iconRightButton:t.createElement(v.A,null),isConfirmButtonLoading:N,isOpen:B,onToggleDialog:()=>R(!1),onConfirm:Y,leftButtonText:{id:"Settings.tokens.Button.cancel",defaultMessage:"Cancel"},rightButtonText:{id:"Settings.tokens.Button.regenerate",defaultMessage:"Regenerate"},title:{id:"Settings.tokens.RegenerateDialog.title",defaultMessage:"Regenerate token"}}))};l.defaultProps={onRegenerate(){},onError:void 0},l.propTypes={onRegenerate:s().func,idToRegenerate:s().oneOfType([s().number,s().string]).isRequired,backUrl:s().string.isRequired,onError:s().func};const m=l,E=({title:I,token:S,setToken:b,canEditInputs:D,canRegenerate:M,isSubmitting:B,backUrl:R,regenerateUrl:F,onErrorRegenerate:N})=>{const{formatMessage:Y}=(0,h.A)(),$=X=>{b({...S,accessKey:X})};return t.createElement(d.Q,{title:S?.name||Y(I),primaryAction:D?t.createElement(r.s,{gap:2},M&&S?.id&&t.createElement(m,{backUrl:F,onRegenerate:$,idToRegenerate:S?.id,onError:N}),t.createElement(o.$,{disabled:B,loading:B,startIcon:t.createElement(i.A,null),type:"submit",size:"S"},Y({id:"global.save",defaultMessage:"Save"}))):M&&S?.id&&t.createElement(m,{onRegenerate:$,idToRegenerate:S?.id,backUrl:F}),navigationAction:t.createElement(a.N_,{startIcon:t.createElement(u.A,null),to:R},Y({id:"global.back",defaultMessage:"Back"})),ellipsis:!0})};E.propTypes={token:s().shape({id:s().oneOfType([s().number,s().string]),type:s().string,lifespan:s().oneOfType([s().number,s().string]),name:s().string,accessKey:s().string,permissions:s().array,description:s().string,createdAt:s().string}),canEditInputs:s().bool.isRequired,canRegenerate:s().bool.isRequired,setToken:s().func.isRequired,isSubmitting:s().bool.isRequired,backUrl:s().string.isRequired,title:s().shape({id:s().string,label:s().string}).isRequired,regenerateUrl:s().string.isRequired,onErrorRegenerate:s().func},E.defaultProps={token:void 0,onErrorRegenerate:void 0};const C=E},44604:(T,g,e)=>{"use strict";e.d(g,{u:()=>o});var t=e(92132),d=e(97366),r=e(94061);const o=({children:a,...i})=>{const{expanded:u,id:A}=(0,d.O)();if(!u)return null;const s=`accordion-content-${A}`,h=`accordion-label-${A}`,v=`accordion-desc-${A}`;return(0,t.jsx)(r.a,{role:"region",id:s,"aria-labelledby":h,"aria-describedby":v,...i,children:a})}},54134:(T,g,e)=>{"use strict";e.d(g,{A:()=>h});var t=e(21272),d=e(88353),r=e(51337),o=e(90625),a=e(2919),i=e(33544),u=e.n(i),A=e(54894);const s=({token:v,tokenType:n})=>{const{formatMessage:c}=(0,A.A)(),l=(0,r.hN)(),{trackUsage:m}=(0,r.z1)(),{copy:E}=(0,r.iD)(),C=I=>async()=>{await E(I)&&(m("didCopyTokenKey",{tokenType:n}),l({type:"success",message:{id:"Settings.tokens.notification.copied"}}))};return t.createElement(r.bQ,{endAction:v&&t.createElement("span",{style:{alignSelf:"start"}},t.createElement(d.K,{label:c({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),onClick:C(v),noBorder:!0,icon:t.createElement(o.A,null),style:{padding:0,height:"1rem"}})),title:v||c({id:"Settings.tokens.copy.editTitle",defaultMessage:"This token isn\u2019t accessible anymore."}),subtitle:c(v?{id:"Settings.tokens.copy.lastWarning",defaultMessage:"Make sure to copy this token, you won\u2019t be able to see it again!"}:{id:"Settings.tokens.copy.editMessage",defaultMessage:"For security reasons, you can only see your token once."}),icon:t.createElement(a.A,null),iconBackground:"neutral100"})};s.defaultProps={token:null},s.propTypes={token:u().string,tokenType:u().string.isRequired};const h=s},55286:(T,g,e)=>{"use strict";e.d(g,{I:()=>t,j:()=>d});const t="api-token",d="transfer-token"},57237:(T,g,e)=>{"use strict";e.d(g,{I:()=>h,n:()=>n});var t=e(92132),d=e(21272),r=e(63891),o=e(97366),a=e(84175),i=e(30893),u=e(83997),A=e(94061);const s=({theme:c,expanded:l,variant:m,disabled:E,error:C})=>C?`1px solid ${c.colors.danger600} !important`:E?`1px solid ${c.colors.neutral150}`:l?`1px solid ${c.colors.primary600}`:m==="primary"?`1px solid ${c.colors.neutral0}`:`1px solid ${c.colors.neutral100}`,h=(0,r.Ay)(i.o)``,v=(0,r.Ay)(A.a)`
  border: ${s};

  &:hover:not([aria-disabled='true']) {
    border: 1px solid ${({theme:c})=>c.colors.primary600};

    ${h} {
      color: ${({theme:c,expanded:l})=>l?void 0:c.colors.primary700};
    }

    ${i.o} {
      color: ${({theme:c,expanded:l})=>l?void 0:c.colors.primary600};
    }

    & > ${u.s} {
      background: ${({theme:c})=>c.colors.primary100};
    }

    [data-strapi-dropdown='true'] {
      background: ${({theme:c})=>c.colors.primary200};
    }
  }
`,n=({children:c,disabled:l=!1,error:m,expanded:E=!1,hasErrorMessage:C=!0,id:I,onToggle:S,toggle:b,size:D="M",variant:M="primary",shadow:B})=>{const R=(0,a.B)(I),F=d.useMemo(()=>({expanded:E,onToggle:S,toggle:b,id:R,size:D,variant:M,disabled:l}),[l,E,R,S,D,b,M]);return(0,t.jsxs)(o.C.Provider,{value:F,children:[(0,t.jsx)(v,{"data-strapi-expanded":E,disabled:l,"aria-disabled":l,expanded:E,hasRadius:!0,variant:M,error:m,shadow:B,children:c}),m&&C&&(0,t.jsx)(A.a,{paddingTop:1,children:(0,t.jsx)(i.o,{variant:"pi",textColor:"danger600",children:m})})]})}},60888:(T,g,e)=>{"use strict";e.d(g,{P:()=>c});var t=e(92132),d=e(9005),r=e(63891),o=e(57237),a=e(97366);const i=({expanded:l,disabled:m,variant:E})=>{let C="neutral100";return l?C="primary100":m?C="neutral150":E==="primary"&&(C="neutral0"),C};var u=e(18629),A=e(58805),s=e(83997),h=e(30893);const v=(0,r.Ay)(u.Q)`
  text-align: left;

  // necessary to make the ellipsis prop work on the title
  > span {
    max-width: 100%;
  }

  svg {
    width: ${14/16}rem;
    height: ${14/16}rem;

    path {
      fill: ${({theme:l,expanded:m})=>m?l.colors.primary600:l.colors.neutral500};
    }
  }
`,n=(0,r.Ay)(s.s)`
  min-height: ${({theme:l,size:m})=>l.sizes.accordions[m]};
  border-radius: ${({theme:l,expanded:m})=>m?`${l.borderRadius} ${l.borderRadius} 0 0`:l.borderRadius};

  &:hover {
    svg {
      path {
        fill: ${({theme:l})=>l.colors.primary600};
      }
    }
  }
`,c=({title:l,description:m,as:E="span",togglePosition:C="right",action:I,...S})=>{const{onToggle:b,toggle:D,expanded:M,id:B,size:R,variant:F,disabled:N}=(0,a.O)(),Y=`accordion-content-${B}`,$=`accordion-label-${B}`,X=`accordion-desc-${B}`,Z=R==="M"?6:4,ne=R==="M"?Z:Z-2,le=i({expanded:M,disabled:N,variant:F}),_={as:E,fontWeight:R==="S"?"bold":void 0,id:$,textColor:M?"primary600":"neutral700",ellipsis:!0,variant:R==="M"?"delta":void 0},de=M?"primary600":"neutral600",ce=M?"primary200":"neutral200",se=R==="M"?`${32/16}rem`:`${24/16}rem`,ae=()=>{N||(D&&!b?(console.warn('Deprecation warning: Usage of "toggle" prop in Accordion component is deprecated. This is discouraged and will be removed in the next major release. Please use "onToggle" instead'),D()):b&&b())},oe=(0,t.jsx)(s.s,{justifyContent:"center",borderRadius:"50%",height:se,width:se,transform:M?"rotate(180deg)":void 0,"data-strapi-dropdown":!0,"aria-hidden":!0,as:"span",background:ce,cursor:N?"not-allowed":"pointer",onClick:ae,shrink:0,children:(0,t.jsx)(A.I,{as:d.A,width:R==="M"?`${11/16}rem`:`${8/16}rem`,color:M?"primary600":"neutral600"})});return(0,t.jsx)(n,{paddingBottom:ne,paddingLeft:Z,paddingRight:Z,paddingTop:ne,background:le,expanded:M,size:R,justifyContent:"space-between",cursor:N?"not-allowed":"",children:(0,t.jsxs)(s.s,{gap:3,flex:1,maxWidth:"100%",children:[C==="left"&&oe,(0,t.jsx)(v,{onClick:ae,"aria-disabled":N,"aria-expanded":M,"aria-controls":Y,"aria-labelledby":$,"data-strapi-accordion-toggle":!0,expanded:M,type:"button",flex:1,minWidth:0,...S,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.I,{..._,children:l}),m&&(0,t.jsx)(h.o,{as:"p",id:X,textColor:de,children:m})]})}),C==="right"&&(0,t.jsxs)(s.s,{gap:3,children:[oe,I]}),C==="left"&&I]})})}},61468:(T,g,e)=>{var t=e(52196);function d(r){var o=r==null?0:r.length;return o?t(r,1,o):[]}T.exports=d},73155:T=>{function g(e){return e!==e}T.exports=g},76610:(T,g,e)=>{var t=e(20920);function d(r,o){return r&&r.length&&o&&o.length?t(r,o):r}T.exports=d},77771:T=>{function g(e,t,d){for(var r=d-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}T.exports=g},80151:(T,g,e)=>{var t=e(97079),d=e(73155),r=e(77771);function o(a,i,u){return i===i?r(a,i,u):t(a,d,u)}T.exports=o},85021:(T,g,e)=>{"use strict";e.d(g,{A:()=>A});var t=e(21272),d=e(43739),r=e(95336),o=e(33544),a=e.n(o),i=e(54894);const u=({name:s,errors:h,values:v,onChange:n,canEditInputs:c,options:l,label:m})=>{const{formatMessage:E}=(0,i.A)();return t.createElement(d.l,{name:s,label:E({id:m.id,defaultMessage:m.defaultMessage}),value:v&&v[s],error:h[s]?E(h[s]?.id?h[s]:{id:h[s],defaultMessage:h[s]}):null,onChange:n,placeholder:"Select",required:!0,disabled:!c},l&&l.map(({value:C,label:I})=>t.createElement(r.c,{key:C,value:C},E(I))))};u.propTypes={name:a().string,options:a().arrayOf(a().shape({label:a().shape({id:a().string,defaultMessage:a().string}),value:a().string})),errors:a().shape({type:a().string}),onChange:a().func.isRequired,canEditInputs:a().bool.isRequired,values:a().shape({type:a().string}).isRequired,label:a().shape({id:a().string,defaultMessage:a().string}).isRequired},u.defaultProps={name:"type",errors:{},options:[]};const A=u},91146:(T,g,e)=>{"use strict";e.d(g,{A:()=>h});var t=e(21272),d=e(43739),r=e(95336),o=e(30893),a=e(33544),i=e.n(a),u=e(54894),A=e(31713);const s=({token:v,errors:n,values:c,onChange:l,isCreating:m})=>{const{formatMessage:E}=(0,u.A)();return t.createElement(t.Fragment,null,t.createElement(d.l,{name:"lifespan",label:E({id:"Settings.tokens.form.duration",defaultMessage:"Token duration"}),value:c.lifespan!==null?c.lifespan:"0",error:n.lifespan?E(n.lifespan?.id?n.lifespan:{id:n.lifespan,defaultMessage:n.lifespan}):null,onChange:C=>{l({target:{name:"lifespan",value:C}})},required:!0,disabled:!m,placeholder:"Select"},t.createElement(r.c,{value:"604800000"},E({id:"Settings.tokens.duration.7-days",defaultMessage:"7 days"})),t.createElement(r.c,{value:"2592000000"},E({id:"Settings.tokens.duration.30-days",defaultMessage:"30 days"})),t.createElement(r.c,{value:"7776000000"},E({id:"Settings.tokens.duration.90-days",defaultMessage:"90 days"})),t.createElement(r.c,{value:"0"},E({id:"Settings.tokens.duration.unlimited",defaultMessage:"Unlimited"}))),t.createElement(o.o,{variant:"pi",textColor:"neutral600"},!m&&`${E({id:"Settings.tokens.duration.expiration-date",defaultMessage:"Expiration date"})}: ${(0,A.N1)(v?.createdAt,parseInt(c.lifespan,10))}`))};s.propTypes={errors:i().shape({lifespan:i().string}),onChange:i().func.isRequired,values:i().shape({lifespan:i().oneOfType([i().number,i().string])}).isRequired,isCreating:i().bool.isRequired,token:i().shape({id:i().oneOfType([i().number,i().string]),type:i().string,lifespan:i().string,name:i().string,accessKey:i().string,permissions:i().array,description:i().string,createdAt:i().string})},s.defaultProps={errors:{},token:{}};const h=s},92173:(T,g,e)=>{var t=e(39226),d=e(76610),r=t(d);T.exports=r},97079:T=>{function g(e,t,d,r){for(var o=e.length,a=d+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}T.exports=g},97366:(T,g,e)=>{"use strict";e.d(g,{C:()=>d,O:()=>r});var t=e(21272);const d=(0,t.createContext)({disabled:!1,expanded:!1,id:"",size:"M",variant:"primary"}),r=()=>(0,t.useContext)(d)}}]);
